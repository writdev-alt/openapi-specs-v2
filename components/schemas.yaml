schemas:
  ValidationError:
    type: object
    properties:
      code:
        type: string
        description: 'Response code following the formula: HTTP status code + service code + case code. Example: 42201001 (422 = HTTP status, 01 = service code, 001 = case code)'
        example: '42201001'
      message:
        type: string
        description: 'Error message indicating validation failure.'
        example: 'The given data was invalid.'
      error:
        type: string
        description: 'Alternative error message format (for simple validation errors).'
        example: 'Invalid or mismatched currency code.'
      errors:
        type: object
        description: 'Object containing field-specific validation errors.'
        additionalProperties:
          type: array
          items:
            type: string
        example:
          wallet_id:
            - 'Wallet not found or does not belong to you.'
          bank_code:
            - 'Invalid Account Number'
          amount:
            - 'Insufficient wallet balance for this withdrawal.'
          trx_id:
            - 'Invalid transaction.'
    oneOf:
      - required: [code, message, errors]
      - required: [code, error]
  
  NotFound:
    type: object
    required:
      - code
      - message
    properties:
      code:
        type: string
        description: 'Response code following the formula: HTTP status code + service code + case code. Example: 40401001 (404 = HTTP status, 01 = service code, 001 = case code)'
        example: '40401001'
      message:
        type: string
        description: 'Error message indicating resource not found.'
        example: 'Transaction not found.'
      success:
        type: boolean
        description: 'Indicates the request was unsuccessful.'
        example: false
      error:
        type: string
        description: 'Alternative error message format.'
        example: 'Withdraw account not found'
    example:
      code: '40401001'
      message: 'Transaction not found.'
      success: false
  
  ServerError:
    type: object
    properties:
      code:
        type: string
        description: 'Response code following the formula: HTTP status code + service code + case code. Example: 50001001 (500 = HTTP status, 01 = service code, 001 = case code)'
        example: '50001001'
      message:
        type: string
        description: 'Error message describing the server error.'
        example: 'Payment processing failed. Please try again.'
      error:
        type: string
        description: 'Alternative error message format.'
        example: 'Gateway error'
      success:
        type: boolean
        description: 'Indicates the request was unsuccessful.'
        example: false
    oneOf:
      - required: [code, message]
      - required: [code, error]
      - required: [code, success, message]
    example:
      code: '50001001'
      error: 'Payment processing failed. Please try again.'
  
  Unauthorized:
    type: object
    required:
      - code
      - message
    properties:
      code:
        type: string
        description: 'Response code following the formula: HTTP status code + service code + case code. Example: 40101001 (401 = HTTP status, 01 = service code, 001 = case code)'
        example: '40101001'
      message:
        type: string
        description: 'Unauthorized access message.'
        example: 'Unauthorized'
    example:
      code: '40101001'
      message: 'Unauthorized'
  
  Forbidden:
    type: object
    required:
      - code
      - message
    properties:
      code:
        type: string
        description: 'Response code following the formula: HTTP status code + service code + case code. Example: 40301001 (403 = HTTP status, 01 = service code, 001 = case code)'
        example: '40301001'
      message:
        type: string
        description: 'Forbidden access message indicating insufficient permissions.'
        example: 'Access denied. You do not have permission to perform this action.'
      success:
        type: boolean
        description: 'Indicates the request was unsuccessful.'
        example: false
    example:
      code: '40301001'
      message: 'Access denied. You do not have permission to perform this action.'
      success: false
  
  SuccessMessage:
    type: object
    required:
      - code
      - message
    properties:
      code:
        type: string
        description: 'Response code following the formula: HTTP status code + service code + case code. Example: 20001001 (200 = HTTP status, 01 = service code, 001 = case code)'
        example: '20001001'
      message:
        type: string
        description: 'Success message.'
        example: 'Withdrawal has been created.'
      status:
        type: string
        description: 'Status indicator (optional).'
        example: 'COMPLETED'
    example:
      code: '20001001'
      message: 'Withdrawal has been created.'
  
  SuccessWithData:
    type: object
    required:
      - code
      - message
      - data
    properties:
      code:
        type: string
        description: 'Response code following the formula: HTTP status code + service code + case code. Example: 20001001 (200 = HTTP status, 01 = service code, 001 = case code)'
        example: '20001001'
      message:
        type: string
        description: 'Success message.'
        example: 'Account information retrieved successfully'
      status:
        type: string
        description: 'Status indicator (optional).'
        example: 'COMPLETED'
      data:
        type: object
        description: 'Response data payload.'
        additionalProperties: true
    example:
      code: '20001001'
      message: 'Account information retrieved successfully'
      data:
        min_limit: 50000
        max_limit: 50000000
  
  TransactionStatus:
    type: string
    enum:
      - pending
      - awaiting_fi_process
      - awaiting_pg_process
      - awaiting_user_action
      - awaiting_admin_approval
      - completed
      - canceled
      - failed
      - refunded
      - expired
    description: |
      Transaction status values:
      - **pending** - Transaction has been created and is waiting to be processed
      - **awaiting_fi_process** - Transaction is waiting for financial institution processing
      - **awaiting_pg_process** - Transaction is waiting for payment gateway processing
      - **awaiting_user_action** - Transaction requires user action (e.g., payment confirmation)
      - **awaiting_admin_approval** - Transaction is pending administrative approval
      - **completed** - Transaction has been successfully completed
      - **canceled** - Transaction was canceled before completion
      - **failed** - Transaction processing failed
      - **refunded** - Transaction has been refunded
      - **expired** - Transaction has expired and is no longer valid
    example: completed
  
  WebhookPayload:
    type: object
    required:
      - event
      - data
      - message
      - status
      - timestamp
    properties:
      event:
        type: string
        description: 'Event type identifier (e.g., "receive_payment")'
        example: receive_payment
      data:
        type: object
        description: 'Event-specific data payload'
        additionalProperties: true
      message:
        type: string
        description: 'Human-readable message describing the event'
        example: Receive Payment via QRIS
      status:
        type: string
        description: 'Transaction status'
        example: completed
      timestamp:
        type: integer
        description: 'Unix timestamp when the event occurred'
        example: 1762943651
    example:
      event: receive_payment
      data:
        trx_id: TRX-2025.11.12-3QS4LURBQ6
        trx_reference: ILONAPAY_69146275622d7
        rrn: '1ittl5s63288'
        amount: '2000.00'
        currency_code: IDR
        description: null
        customer_name: null
        customer_email: null
        customer_phone: null
        merchant_id: 22
        merchant_name: KPK79
        payment_method: QRIS
      message: Receive Payment via QRIS
      status: completed
      timestamp: 1762943651
  
  PaymentWebhookData:
    type: object
    required:
      - trx_id
      - amount
      - currency_code
      - merchant_id
      - merchant_name
      - payment_method
    properties:
      trx_id:
        type: string
        description: 'Unique transaction identifier generated by the system'
        example: TRX-2025.11.12-3QS4LURBQ6
      trx_reference:
        type: string
        nullable: true
        description: "Merchant's transaction reference (if provided)"
        example: ILONAPAY_69146275622d7
      rrn:
        type: string
        nullable: true
        description: 'Retrieval Reference Number from the payment gateway'
        example: '1ittl5s63288'
      amount:
        type: string
        description: 'Payment amount as a decimal string'
        example: '2000.00'
      currency_code:
        type: string
        description: 'Currency code (e.g., "IDR")'
        example: IDR
      description:
        type: string
        nullable: true
        description: 'Customer-facing description'
        example: null
      customer_name:
        type: string
        nullable: true
        description: "Customer's full name"
        example: null
      customer_email:
        type: string
        nullable: true
        description: "Customer's email address"
        example: null
      customer_phone:
        type: string
        nullable: true
        description: "Customer's phone number"
        example: null
      merchant_id:
        type: integer
        description: 'Merchant ID'
        example: 22
      merchant_name:
        type: string
        description: 'Merchant name'
        example: KPK79
      payment_method:
        type: string
        description: 'Payment method used (e.g., "QRIS")'
        example: QRIS
  
  WithdrawalWebhookData:
    type: object
    required:
      - trx_id
      - amount
      - net_amount
      - payable_amount
      - currency_code
      - status
      - merchant_id
      - withdrawal_method
      - trx_fee
      - environment
      - is_sandbox
    properties:
      trx_id:
        type: string
        description: 'Unique transaction identifier generated by the system'
        example: TRX-2025.01.15-ABC123XYZ
      trx_reference:
        type: string
        nullable: true
        description: "Merchant's transaction reference (if provided)"
        example: WD-2025-0001
      amount:
        type: string
        description: 'Original withdrawal amount as a decimal string'
        example: '250000.00'
      net_amount:
        type: string
        description: 'Net amount after fees as a decimal string'
        example: '245000.00'
      payable_amount:
        type: string
        description: 'Final amount to be paid out as a decimal string'
        example: '245000.00'
      currency_code:
        type: string
        description: 'Currency code (e.g., "IDR")'
        example: IDR
      status:
        type: string
        description: 'Withdrawal status (e.g., "pending", "completed", "failed")'
        example: completed
      description:
        type: string
        nullable: true
        description: 'Description of the withdrawal'
        example: Withdrawal to Bank BCA
      merchant_id:
        type: integer
        description: 'Merchant ID'
        example: 22
      merchant_name:
        type: string
        nullable: true
        description: 'Merchant business name'
        example: KPK79
      withdrawal_method:
        type: string
        description: 'Withdrawal method used (e.g., "Bank Transfer")'
        example: Bank Transfer
      account_name:
        type: string
        nullable: true
        description: 'Name of the withdrawal account'
        example: Bank BCA
      account_holder_name:
        type: string
        nullable: true
        description: "Account holder's full name"
        example: Budi Santoso
      account_bank_name:
        type: string
        nullable: true
        description: 'Bank name for the withdrawal account'
        example: Bank Central Asia
      account_number:
        type: string
        nullable: true
        description: 'Account number for withdrawal'
        example: '1234567890'
      account_bank_code:
        type: string
        nullable: true
        description: 'Bank code (e.g., "014" for BCA)'
        example: '014'
      trx_fee:
        type: string
        description: 'Transaction fee charged as a decimal string'
        example: '5000.00'
      remarks:
        type: string
        nullable: true
        description: 'Additional remarks or notes'
        example: Withdrawal processed successfully
      environment:
        type: string
        description: 'Environment where the transaction occurred ("production" or "sandbox")'
        example: production
      is_sandbox:
        type: boolean
        description: 'Whether the transaction is in sandbox mode'
        example: false

